<!--
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>게시물 상세보기</title>
    <link rel="stylesheet" href="boarddetail.css" />
</head>
<body>
<H1 th:text="${board.title}"></H1>
<div>글쓴이 : <span th:text="${board.name}"></span></div>
<div>제목 : <span th:text="${board.title}"></span></div>
<div>조회수 : <span th:text="${board.viewCnt}"></span></div>
<div>작성일 : <span th:text="${board.regdate}"></span></div>
<div>내용 : <span th:text="${board.content}"></span></div>

<div><a href="/">목록보기</a></div>
<div><a th:href="@{/updateform(boardId=${board.boardId})}">수정하기</a></div>
<div><a onclick='confirmDelete();' th:href="@{/delete(boardId=${board.boardId})}">삭제하기</a></div>
</body>
</html>

-->

<!--
댓글 목록
<h3>댓글 목록</h3>
<ul>
    <li th:each="comment : ${comments}">
        <p th:text="${comment.content}"></p>
        <form action="/addSubcomment" method="post">
            <input type="hidden" name="commentId" th:value="${comment.commentId}">
            <textarea name="content" placeholder="서브댓글 내용"></textarea>
            <button type="submit">서브댓글 작성</button>
        </form>
        <ul>
            <li th:each="subcomment : ${comment.subcomments}">
                <p th:text="${subcomment.content}"></p>
            </li>
        </ul>
    </li>
</ul>


 댓글 작성 폼
<form action="/addComment" method="post">
    <input type="hidden" name="boardId" th:value="${board.boardId}">
    <textarea name="content" placeholder="댓글 내용"></textarea>
    <button type="submit">댓글 작성</button>
</form>

<script>
    // 댓글 작성 폼 제출 이벤트 핸들러
    document.querySelector('form[action="/addComment"]').addEventListener('submit', function(event) {
        event.preventDefault(); // 폼의 기본 동작인 페이지 전환을 막음

        // 댓글 작성 폼 데이터를 FormData 객체로 가져옴
        const formData = new FormData(this);

        // AJAX 요청 생성
        const xhr = new XMLHttpRequest();
        xhr.open('POST', this.action);
        xhr.onreadystatechange = function() {
            if (xhr.readyState === XMLHttpRequest.DONE) {
                if (xhr.status === 200) {
                    // 댓글 작성 성공한 경우, 새로운 댓글을 페이지에 추가
                    const newComment = createCommentElement(xhr.responseText);
                    const commentList = document.querySelector('ul');
                    commentList.appendChild(newComment);

                    // 댓글 작성 폼 초기화
                    document.querySelector('form[action="/addComment"] textarea').value = '';
                } else {
                    // 댓글 작성 실패한 경우, 오류 메시지를 표시하거나 다른 처리를 수행
                    console.error('댓글 작성 실패:', xhr.responseText);
                }
            }
        };

        // AJAX 요청 전송
        xhr.send(formData);
    });

    // 새로운 댓글을 생성하여 HTML 요소로 반환하는 함수
    function createCommentElement(commentData) {
        const comment = JSON.parse(commentData);

        const li = document.createElement('li');
        const p = document.createElement('p');
        p.textContent = comment.content;
        li.appendChild(p);

        return li;
    }


    function confirmDelete() {
        if (confirm("삭제하시겠습니까?")) {
            alert("게시글이 삭제되었습니다.");
        }
    }
</script> -->

<!-- boarddetail.html -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>게시물 상세보기</title>
    <link rel="stylesheet" href="boarddetail.css" />
</head>
<body>
<table class="board-details">
    <tr>
        <th>글쓴이</th>
        <td><span th:text="${board.name}"></span></td>
    </tr>
    <tr>
        <th>제목</th>
        <td><span th:text="${board.title}"></span></td>
    </tr>
    <tr>
        <th>조회수</th>
        <td><span th:text="${board.viewCnt}"></span></td>
    </tr>
    <tr>
        <th>작성일</th>
        <td><span th:text="${board.regdate}"></span></td>
    </tr>
    <tr>
        <th>내용</th>
        <td><span th:text="${board.content}"></span></td>
    </tr>
</table>

<div class="button-group">
    <a href="/">목록보기</a>
    <a th:href="@{/updateform(boardId=${board.boardId})}">수정하기</a>
    <a onclick='confirmDelete();' th:href="@{/delete(boardId=${board.boardId})}">삭제하기</a>
</div>
</body>
</html>

